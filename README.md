# Система оценки профессиональных рисков
## Системные требования

- **Python 3.8 или новее**
- **Операционная система:** Windows 10/11
- **Свободное место на диске:** ~500 МБ
- **Оперативная память:** 2 ГБ (рекомендуется 4 ГБ)

## Быстрый старт

1. **Скачайте проект:**
   - Нажмите зелёную кнопку `Code` -> `Download ZIP`
   - Распакуйте архив в любую папку

2. **Установите Python** (если ещё не установлен):
   - Скачайте с https://www.python.org/downloads/
   - **ВАЖНО:** При установке отметьте галочку **"Add Python to PATH"**

3. **Запустите программу:**
   - Дважды кликните на файл `run_sever.bat`
   - Подождите, пока установятся все необходимые библиотеки (только при первом запуске)

4. Откройте браузер и перейдите по адресу: `http://127.0.0.1`

## Инструкция по использованию

### Шаг 0: Выбор сценария работы

На главной странице доступны три варианта:

- **Новый проект** – начать оценку рисков для организации с загрузки файлов.
- **Открыть проект** – продолжить работу над ранее созданным проектом (функция в разработке).
- **Создать шаблон должности** – сформировать JSON-шаблон с типовыми значениями для конкретной должности, чтобы использовать его в будущих проектах.

---

### Сценарий 1: Новый проект

#### Шаг 1: Загрузка файлов
1. Укажите дату документа.
2. Загрузите обязательные файлы:
   - **Шаблон карты** (card_template.docx)
   - **Шаблон отчёта** (rep_template.docx)
   - **Список сотрудников** (people.xlsx) – содержит перечень должностей и ФИО.
   - **Данные организации** (org.xlsx) – реквизиты организации.

#### Шаг 2: Оценка рисков по работникам
После загрузки откроется страница со списком всех работников. Для каждого можно:

- **Заполнить вручную** – нажать на кнопку «Заполнить вручную» и на отдельной странице проставить:
  - Степень травмирования (1–5)
  - Вероятность (1–5)
  - Коэффициент (0; 0,1; 0,3; 0,5; 0,7; 0,9)
- **Применить готовый шаблон** – выбрать JSON-файл, созданный ранее и нажать «Применить шаблон». Данные автоматически подставятся, и карта для этого работника будет сгенерирована немедленно.
- **Сохранить как шаблон** – на странице ручного заполнения есть кнопка «Сохранить как шаблон», которая выгружает текущие значения в JSON-файл для последующего использования.
- **Важно**: если сохранить шаблон и сразу перейти обратно к списку работников, программа не сохранит заполненные данные (будет только скачан шаблон). Для того, чтобы не загружать скачаный шаблон в ту же самую должность следует сначала нажать кнопку <<Сохранить как шаблон>>, после нажать кнопку <<Сохранить и перейти далее>> и только после этого возвращаться к списку работников, нажав кнопку <<К списку работников>>.

После заполнения (или применения шаблона) статус работника меняется на «Сгенерировано».

#### Шаг 3: Формирование итоговых документов
Когда все работники обработаны, нажмите **«Сформировать все отчёты»**. Система создаст:

- Карты оценки рисков для каждого работника (формат .docx)
- Итоговый отчёт (формат .docx)

Все файлы упаковываются в ZIP-архив.

Кроме того, система автоматически 

#### Шаг 4: Скачивание и завершение работы
- Нажмите **«Скачать ZIP-архив»**, чтобы сохранить результаты.
- Для остановки сервера и очистки временных файлов используйте кнопку **«Завершить работу»** (доступна в интерфейсе или по адресу `/shutdown`).

---

### Сценарий 2: Создание шаблона должности

1. На главной странице выберите **«Создать шаблон должности»**.
2. В открывшейся форме:
   - Введите название должности.
   - Для каждого риска выберите нужные значения (степень, вероятность, коэффициент). По умолчанию поля предзаполнены значениями из базы данных, но их можно изменить.
3. Нажмите **«Скачать шаблон»** – браузер сохранит JSON-файл с именем, соответствующим названию должности.

Этот файл можно будет загрузить в любом новом проекте (см. Шаг 3 сценария 1).

---
## Решение проблем

### Нужно изменить значения по умолчанию

### Нужно немного изменить существующий шаблон

### Python не найден

Переустановите Python с галочкой "Add Python to PATH"

## Последнее изменение 
17.02.2026
## Версия
1.1
